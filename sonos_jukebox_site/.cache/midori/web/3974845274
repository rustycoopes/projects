window.page3_callback(["<div class=\"newpage\" id=\"page3\" style=\"width: 902px; height:1167px\">\n<div class=text_layer style=\"z-index:2\"><div class=ie_fix>\n&nbsp;\n<div class=\"ff0\" style=\"font-size:75px\">\n<span class=a style=\"left:442px;top:85px\"> </span><span class=a style=\"left:792px;top:172px;word-spacing:-5px\">SoapMessage = <span class=w6></span>SOAP_TEMPLATE%(track)</span><span class=a style=\"left:792px;top:260px;word-spacing:-6px\">webservice = <span class=w9></span>httplib.HTTP(\"192.168<span class=l6>.1.70:1400\")</span></span><span class=a style=\"left:792px;top:347px;word-spacing:-16px\">webservice.putrequest(<span class=l6>\"POST\", <span class=w style=\"width:14px\"></span>\"/MediaRenderer/AVTransp<span class=l6>ort/Control\")</span></span></span><span class=a style=\"left:792px;top:435px;word-spacing:-12px\">webservice.putheader(\"<span class=l6>Host\", <span class=w11></span>\"192.168.1.70:1400\")</span></span><span class=a style=\"left:792px;top:522px;word-spacing:-6px\">webservice.putheader(\"<span class=l6>User-Agent\", \"Python <span class=w7></span>post\")</span></span><span class=a style=\"left:792px;top:610px;word-spacing:-8px\">webservice.putheader(\"<span class=l6>Content-type\", \"text/xml; <span class=w10></span>charset=\\\"UTF-8\\\"\")</span></span><span class=a style=\"left:792px;top:697px;word-spacing:-5px\">webservice.putheader(\"<span class=l6>Content-length\", \"%d\" % <span class=w9></span>len(SoapMessage))</span></span><span class=a style=\"left:792px;top:785px;word-spacing:-18px\">webservice.putheader(\"<span class=l6>SOAPAction\", <span class=w style=\"width:15px\"></span>\"urn:schemas-upnp-org:s<span class=l6>ervice:AVTrans</span></span></span><span class=a style=\"left:442px;top:872px\">port:1#AddURIToQueue\")</span><span class=a style=\"left:792px;top:960px\">webservice.endheaders()</span><span class=a style=\"left:792px;top:1047px\">webservice.send(SoapMessage)</span><span class=a style=\"left:442px;top:1310px;word-spacing:1px\">#this is the <span class=l7>main loop. <span class=w style=\"width:40px\"></span>We poll the <span class=l6>GPIO port unt<span class=l6>il there is <span class=l6>a pulse.</span></span></span></span></span><span class=a style=\"left:442px;top:1397px;word-spacing:-2px\">#sometimes there can be random pulses, or a spike when <span class=w6></span>the rotor arm starts to m</span><span class=a style=\"left:442px;top:1485px\">ove</span><span class=a style=\"left:442px;top:1572px;word-spacing:-2px\">#so before trying to decode the pulse train I <span class=w6></span>check that</span><span class=a style=\"left:442px;top:1660px;word-spacing:-2px\">#the pulse is long enough to indicate a <span class=w6></span>contact on the selector arm</span><span class=a style=\"left:442px;top:1835px;word-spacing:-3px\">while True:</span><span class=a style=\"left:617px;top:1922px;word-spacing:-6px\">if GPIO.input(WALLBOX):</span><span class=a style=\"left:792px;top:2010px;word-spacing:-7px\">if <span class=w6></span>state_has_changed(True)<span class=l6>:</span></span><span class=a style=\"left:967px;top:2097px;word-spacing:-3px\">track = calculate_track()</span><span class=a style=\"left:967px;top:2185px\">play_song(track)</span><span class=a style=\"left:792px;top:2272px\">else:</span><span class=a style=\"left:967px;top:2360px;word-spacing:-3px\">print (\"--&gt; Pulse ignored\")</span><span class=a style=\"left:442px;top:2535px\"> </span></div>\n</div>\n</div>\n</div>\n\n"]);